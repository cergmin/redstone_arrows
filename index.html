<html>
	<head>
		<title>Redstone Arrows</title>
		<link rel="stylesheet" href="style.css">
	</head>
	<body>
		<div class="loading_screen">
			0%
		</div>
		<div class="menu">
			<div class="menu__block" block="redstone_source" style="background-image: url('./images/redstone_source.png');"></div>
			<div class="menu__block selected" block="simple_arrow" style="background-image: url('./images/simple_arrow.png');"></div>
			<div class="menu__block" block="pull_arrow" style="background-image: url('./images/pull_arrow.png');"></div>
			<div class="menu__block" block="double_arrow" style="background-image: url('./images/double_arrow.png');"></div>
			<div class="menu__block" block="logical_and" style="background-image: url('./images/logical_and.png');"></div>
			<div class="menu__block" block="logical_not" style="background-image: url('./images/logical_not.png');"></div>
			<div class="menu__block" block="info" style="background-image: url('./images/info.png');"></div>
		</div>
		<div class="main">
			<table id="area"></table>
		</div>
	</body>
	<script src="./scripts/jquery.min.js"></script>
	<script src="./scripts/utilities.js"></script>
	<script src="./scripts/area.js"></script>
	<script src="./scripts/blocks.js"></script>
	<script>
		let loading = 0;
		let area_size = [60, 30];

		// let mouse_buttons = {
		// 	0: false,
		// 	1: false,
		// 	2: false
		// };

		// let keys_down = {
		// 	9: false, // Tab
		// 	16: false, // Shift
		// 	17: false, // Ctrl
		// 	27: false // Esc
		// }

		// let mouse_last_position = [0, 0];
		// let first_cell = [0, 0];

		// function set_cell_with_this(e){
		// 		console.log(mouse_buttons);
		// 	if(mouse_buttons[2]){
		// 		if(keys_down[16]){
		// 			clear_cell(this.cellIndex + 2, this.parentNode.rowIndex + 2);
		// 		}
		// 		else{
		// 			let direction = 1;
		// 			let vector = normalize(e.clientX - mouse_last_position[0], 
		// 										e.clientY - mouse_last_position[1]);
		// 			let angle = Math.atan2(vector.y, vector.x) * 180 / Math.PI;

		// 			if( angle <= -45 && angle > -130 ){
		// 				direction = 1;
		// 			} else if( angle > -180 && angle <= -130 || angle <= 180 && angle > 130 ){
		// 				direction = 4;
		// 			} else if( angle > 45 && angle <= 130 ){
		// 				direction = 3;
		// 			} else if( angle <= 45 && angle > -45 ){
		// 				direction = 2;
		// 			}

		// 			set_cell(this.cellIndex + 2, this.parentNode.rowIndex + 2, 'simple_arrow', direction);
		// 		}
		// 	}

		// 	mouse_last_position = [e.clientX, e.clientY];
		// }

		// $(document).on("keydown", function(e){
		// 	keys_down[e.which] = true;
		// });

		// $(document).on("keyup", function(e){
		// 	keys_down[e.which] = false;
		// });

		// $("#area").on("mouseup", "tr td", function(e){
		// 	if(first_cell[0] == this.cellIndex + 2 && 
		// 		first_cell[1] == this.parentNode.rowIndex + 2 &&
		// 		mouse_buttons[2]){

		// 		let type = get_cell(this.cellIndex + 2, this.parentNode.rowIndex + 2).type;

		// 		if(type == 'simple_arrow'){
		// 			let direction = get_cell(this.cellIndex + 2, this.parentNode.rowIndex + 2).direction;
		// 			direction = parseInt(direction);
		// 			direction += 1;

		// 			if(direction > 4){
		// 				direction = 1;
		// 			}

		// 			set_cell(this.cellIndex + 2,
		// 						this.parentNode.rowIndex + 2, 
		// 						'simple_arrow',
		// 						direction);
		// 		}
		// 	}

		// 	mouse_buttons[e.button] = false;
		// 	e.preventDefault();
		// 	return false;
		// });

		// $("#area").on("mousedown", "tr td", function(e){

		// 	mouse_buttons[e.button] = true;
		// 	mouse_last_position = [e.clientX, e.clientY];
		// 	first_cell = [this.cellIndex + 2, this.parentNode.rowIndex + 2];

		// 	console.log(mouse_buttons);
		// 	console.log();

		// 	set_cell_with_this.call(this, e);
		// });

		// $("#area").on("mousemove", "tr td", set_cell_with_this);

		create_area_interval = setInterval(function(){
			let i = 0;
			return function(){
				if(i >= area_size[1]){
					$(".loading_screen").remove();
					return;
				}

				$("#area").append('<tr></tr>');
				for(let i = 0; i < area_size[0]; i++){
					$("#area tr:last-child").append('<td></td>');
				}

				loading += 100 / area_size[1];
				$(".loading_screen").html(Math.trunc(loading) + '%');

				$("#area").attr('style', 'width: ' + (area_size[0] * 30) + 'px; height: ' + (i * 30) + 'px');	

				i++;
			}
		}(),
		0
	);
	</script>
</html>